\documentclass[uplatex,a4j,11pt,dvipdfmx]{jsarticle}
\bibliographystyle{jplain}

\usepackage{url}

\usepackage{graphicx}
\usepackage{gnuplot-lua-tikz}
\usepackage{pgfplots}
\usepackage{tikz}
\usepackage{amsmath,amsfonts,amssymb}
\usepackage{bm}
\usepackage{siunitx}

\makeatletter
\def\fgcaption{\def\@captype{figure}\caption}
\makeatother
\newcommand{\setsections}[3]{
\setcounter{section}{#1}
\setcounter{subsection}{#2}
\setcounter{subsubsection}{#3}
}
\newcommand{\mfig}[3][width=15cm]{
\begin{center}
\includegraphics[#1]{#2}
\fgcaption{#3 \label{fig:#2}}
\end{center}
}
\newcommand{\gnu}[2]{
\begin{figure}[hptb]
\begin{center}
\input{#2}
\caption{#1}
\label{fig:#2}
\end{center}
\end{figure}
}

\begin{document}
\title{}
\author{61908697 佐々木良輔}
\date{}
\maketitle
図\ref{fig:fig1.jpg}のようなグラフを作成しMax FlowをFord-Fulkerson法を用いて計算した.
結果は図\ref{fig:fig2.jpg}のようになり,Max Flowは15となった.ここで黒文字はその辺のCapacity, 赤文字は実際のFlowを表している.
\mfig[width=10cm]{fig1.jpg}{計算するグラフ}
\mfig[width=10cm]{fig2.jpg}{結果}
\end{document}